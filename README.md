# にっスマ！🏸

**バドミントン参加管理アプリ**

日程をスマートに調整！バドミントンなどのイベント参加を簡単に管理できるWebアプリケーションです。主催者が仮スケジュールを作成し、参加者から回答を集め、一定の条件が整ったら本スケジュールとして確定できます。

**「にっスマ！」** = 日程をスマートに調整するツールです。

## 🎯 プロジェクトの目標

- 主催者がイベントの仮スケジュールを簡単に作成できる
- 参加者が期限内に参加/不参加/未定を回答できる
- 回答状況を可視化し、主催者が適切なタイミングで本スケジュールに確定できる
- すべての回答データを引き継ぎながらスケジュールステータスを管理できる

## ✨ 主な機能

### 完成済み機能

#### 1. イベント作成（主催者向け）
- **入力項目**
  - イベント名
  - 開催日時
  - 開催場所
  - 参加費用
  - 回答期限
  - 必要参加人数（オプション）
  - 詳細説明（オプション）
  - 主催者パスワード（管理用）

- すべてのイベントは最初「仮スケジュール」として作成されます
- 主催者パスワードを設定することで、後から管理・確定が可能

#### 2. イベント一覧・閲覧（参加者向け）
- **フィルター機能**
  - すべてのイベント
  - 仮スケジュールのみ
  - 本スケジュールのみ

- **表示情報**
  - イベント名
  - 開催日時・場所
  - 参加費用
  - 回答期限（期限切れの場合は警告表示）
  - ステータスバッジ（仮/本）

#### 3. 参加回答機能
- イベント詳細画面から直接回答できます
- **回答項目**
  - 参加者名
  - 回答（参加/不参加/未定）
  - コメント（任意）

- 回答状況がリアルタイムに集計表示されます
- **参加者名が状況ごとに表示されます**（参加者/不参加者/未定者）
- コメントがある場合は吹き出しアイコンが表示されます
- 同じイベントに複数回答可能（後から回答を追加できます）

#### 3-1. 回答の編集・削除機能 🆕
- **参加者名をクリック**すると編集・削除メニューが表示されます
- **できること**
  - 回答ステータスの変更（参加 ⇄ 不参加 ⇄ 未定）
  - 回答の削除
- 誰でも編集・削除できるので、間違えた回答の修正が簡単です

#### 4. イベント管理（主催者向け）
- パスワード認証により主催者のみアクセス可能
- **管理機能**
  - 回答状況の確認（参加/不参加/未定の人数）
  - **参加者名の一覧表示**（状況ごとに分類）
  - 参加者名をクリックして回答の編集・削除が可能 🆕
  - 回答者一覧とコメントの詳細閲覧（折りたたみ式）
  - 本スケジュールへの確定
  - **個別イベントの削除機能** 🆕
    - 選択中のイベントと関連する回答を削除
    - 二重確認で誤操作を防止

#### 5. 仮→本スケジュール移行機能
- 主催者が任意のタイミングで確定可能
- **移行時の動作**
  - すべての回答データを保持したまま移行
  - ステータスが「本スケジュール」に変更
  - 確定後も引き続き参加者は回答可能
  - イベント一覧でのフィルタリングに反映

## 📊 データ構造

### イベントテーブル (events)
| フィールド名 | 型 | 説明 |
|------------|-----|------|
| id | text | イベントID（UUID） |
| title | text | イベント名 |
| datetime | datetime | 開催日時 |
| location | text | 開催場所 |
| cost | number | 参加費用 |
| deadline | datetime | 回答期限 |
| status | text | ステータス (tentative/confirmed) |
| description | text | 詳細説明 |
| required_participants | number | 必要参加人数 |
| organizer_password | text | 主催者パスワード |

### 回答テーブル (responses)
| フィールド名 | 型 | 説明 |
|------------|-----|------|
| id | text | 回答ID（UUID） |
| event_id | text | イベントID |
| participant_name | text | 参加者名 |
| response_status | text | 回答 (attending/not_attending/undecided) |
| comment | text | コメント |

## ⚠️ 重要な注意事項

### 動作環境について

**このアプリケーションはFirebase Firestoreを使用してデータを管理しています。**

GitHub Pagesで公開可能で、以下の環境で動作します：
- GitHub Pages（静的サイトホスティング）
- Firebase Firestore（データベース）

#### デプロイ方法

詳細な手順は **`DEPLOYMENT_GUIDE.md`** を参照してください。

#### Firebase セキュリティ設定

⚠️ **デプロイ前に必ずFirebaseセキュリティルールを設定してください！**

詳細は **`FIREBASE_SECURITY_RULES.md`** を参照してください。

### データ削除について

- **個別削除**: 主催者がパスワード認証後、イベント管理画面から実行可能
- **全削除**: 開発管理者のみ、保護ファイル削除により実行可能（詳細は「開発管理者向け機能」を参照）

## 🚀 使い方

### 🎬 初めてご利用の方へ

サイトを開くと、上部に**3つのタブ**が表示されます：
- **イベント一覧**: すべてのイベントを閲覧
- **イベント作成**: 新しいイベントを作成（主催者用）
- **イベント管理**: イベントを管理・確定（主催者用）

タブをクリックすると、画面が切り替わります。

### 主催者の場合

1. **イベント作成**
   - **「イベント作成」タブ**をクリック
   - 必要事項を入力し、主催者パスワードを設定
   - 「仮スケジュールとして作成」ボタンをクリック

2. **回答状況の確認**
   - 「イベント管理」タブを開く
   - 管理したいイベントを選択
   - 主催者パスワードを入力して認証
   - 回答状況と回答者一覧を確認

3. **本スケジュールへの確定**
   - イベント管理画面で回答状況を確認
   - 必要な回答数が集まったら「本スケジュールとして確定する」ボタンをクリック
   - 確定後も参加者は引き続き回答可能

4. **個別イベントの削除** 🆕
   - イベント管理画面の下部「危険な操作」セクション
   - 選択中のイベントとその回答を削除
   - 二重確認で誤操作を防止

### 参加者の場合

1. **イベントの閲覧**
   - 「イベント一覧」タブでイベントを確認
   - フィルターで仮/本スケジュールを絞り込み可能

2. **参加回答**
   - イベントカードをクリックして詳細を表示
   - 名前と回答（参加/不参加/未定）を入力
   - 必要に応じてコメントを追加
   - 「回答を送信」ボタンをクリック

3. **回答状況の確認**
   - イベント詳細画面で現在の回答状況（人数）を確認可能

## 🛠️ 技術スタック

- **フロントエンド**
  - HTML5
  - Tailwind CSS（レスポンシブデザイン）
  - JavaScript（Vanilla JS）
  - Font Awesome（アイコン）

- **バックエンド**
  - Firebase Firestore（NoSQLデータベース）
  - Firebase SDK v10.7.1

- **ホスティング**
  - GitHub Pages対応

## 📁 ファイル構造

```
.
├── index.html                    # メインHTMLファイル（Firebase統合版）
├── app.js                        # メインJavaScriptファイル（Firestore対応）
├── README.md                     # プロジェクト説明書（このファイル）
├── DEPLOYMENT_GUIDE.md           # GitHub Pagesデプロイメント手順
├── FIREBASE_SECURITY_RULES.md    # Firebaseセキュリティルール設定ガイド
├── HOW_TO_DELETE_ALL_DATA.md     # 開発者向けデータ削除手順
├── RESET_ALL_DATA.txt            # データ削除保護ファイル（開発環境専用）
└── index-old-restapi.html        # 旧版（REST API使用・開発環境専用）
```

## 🔐 セキュリティについて

- 主催者パスワードは平文で保存されています
- Firebaseセキュリティルールで適切なアクセス制御を設定してください（`FIREBASE_SECURITY_RULES.md` 参照）
- 現在の実装は小規模なイベント管理用です
- 本番環境では必ずセキュリティルールを設定してください

## 📱 レスポンシブ対応

- デスクトップ、タブレット、スマートフォンに対応
- Tailwind CSSのユーティリティクラスによる柔軟なレイアウト

## 🎨 デザイン特徴

- モダンで直感的なUI
- カラーコーディング
  - 黄色：仮スケジュール
  - 緑色：本スケジュール、参加
  - 赤色：不参加
  - 黄色：未定
- Font Awesomeアイコンで視覚的にわかりやすく

## 🔄 ワークフロー例

```
1. 主催者がイベント作成（仮スケジュール）
   ↓
2. 参加者が回答を送信
   ↓
3. 主催者が回答状況を確認
   ↓
4. 必要な回答数が集まる
   ↓
5. 主催者が本スケジュールに確定
   ↓
6. 確定後も追加の回答を受付可能
```

## 🔧 開発管理者向け機能

### すべてのデータを削除（完全リセット）

**⚠️ 開発環境専用機能**

データベース内のすべてのイベントと回答を完全に削除する機能です。

詳細は **`HOW_TO_DELETE_ALL_DATA.md`** を参照してください。

**重要:** この機能は開発環境でのみ使用可能です。GitHub Pagesにデプロイした本番環境では動作しません（セキュリティのため）。

---

## 💡 推奨される次のステップ

### 機能追加案

1. **回答の編集・削除機能**
   - 参加者が自分の回答を変更できる機能
   - 識別用のトークンやメールアドレスでの認証

2. **通知機能**
   - 新しい回答が届いたときの通知
   - 回答期限が近づいた際のリマインダー
   - イベント確定時の通知

3. **エクスポート機能**
   - 回答者リストのCSVダウンロード
   - イベント情報の印刷用フォーマット

4. **統計・分析機能**
   - 回答率の推移グラフ
   - 参加傾向の分析
   - 過去のイベント統計

5. **イベント編集機能**
   - 作成後のイベント情報の変更
   - 日時や場所の更新通知

6. **複数日程調整機能**
   - 複数の候補日から最適な日を選ぶ
   - 投票形式での日程調整

7. **コメント機能**
   - イベントへの質問・コメント掲示板
   - 参加者同士のコミュニケーション

8. **カテゴリー・タグ機能**
   - イベントの分類
   - タグによる検索・フィルタリング

### UI/UX改善案

1. **検索機能**
   - イベント名や場所での検索
   - 日付範囲での絞り込み

2. **ソート機能**
   - 日付順、回答数順での並び替え

3. **ダークモード**
   - ユーザー設定によるテーマ切り替え

4. **アニメーション強化**
   - スムーズなトランジション
   - ローディング状態の表示

### セキュリティ強化

1. **パスワードのハッシュ化**
   - クライアント側でのハッシュ化
   - より安全な認証方式

2. **アクセス制限**
   - イベントごとのアクセスコード
   - 参加者の限定公開

3. **スパム対策**
   - reCAPTCHA導入
   - レート制限

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 コントリビューション

改善提案やバグ報告は大歓迎です！

---

## 🚀 デプロイ方法

GitHub Pagesへのデプロイ手順：

1. **`DEPLOYMENT_GUIDE.md`** の手順に従ってください
2. Firebaseセキュリティルールを設定（**`FIREBASE_SECURITY_RULES.md`** 参照）
3. GitHubリポジトリにファイルをアップロード
4. GitHub Pages設定を有効化
5. 公開URLにアクセス！

---

**作成日**: 2025年10月28日  
**バージョン**: 2.0.0 (Firebase対応版)  
**最終更新**: 2025年10月28日
