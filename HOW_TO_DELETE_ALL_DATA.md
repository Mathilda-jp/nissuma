# 全データ削除の手順（開発管理者専用）

## ⚠️ 警告

この手順は**開発環境でのみ**使用してください。
本番環境で実行すると、すべてのユーザーデータが失われます。

---

## 📝 手順

### ステップ 1: 保護ファイルを削除

開発環境で以下のファイルを削除してください：

```
RESET_ALL_DATA.txt
```

**削除方法:**
- ファイル管理画面から削除
- または CLI で `Delete` コマンドを使用

### ステップ 2: サイトをリロード

ブラウザでサイトを開き、ページを更新してください：

- **Windows/Linux**: `F5` または `Ctrl + R`
- **Mac**: `Cmd + R`

### ステップ 3: 削除の確認

ブラウザの開発者ツール（F12）でコンソールを確認：

```
🔴 リセットトリガー検出: 全データを削除します
🗑️ 全データ削除を開始...
✅ 削除完了: イベント X件、回答 Y件
```

画面上部に通知が表示されます：
```
管理者によりデータがリセットされました（イベント: X件、回答: Y件）
```

### ステップ 4: 保護ファイルを再作成

削除後は**必ず**保護ファイルを再作成してください：

**ファイル名:** `RESET_ALL_DATA.txt`

**内容:** （README.mdと同じ内容をコピー）

---

## 🔒 セキュリティ

### なぜこの方法？

- ✅ **誤操作防止**: ボタン1つで削除できない
- ✅ **開発者専用**: ファイルシステムにアクセスできる人のみ
- ✅ **一般ユーザー保護**: 公開サイトからは実行不可能
- ✅ **意図的操作**: ファイル削除という明確なアクションが必要

### 保護される対象

- 一般ユーザー（公開サイト利用者）
- 主催者（イベント管理者）
- 参加者（回答者）

### アクセスできる人

- 開発環境の管理者
- ファイルシステムへのアクセス権を持つ人

---

## 🔄 動作の仕組み

```
1. ページ読み込み時
   ↓
2. RESET_ALL_DATA.txt の存在確認
   ↓
3. ファイルが存在しない？
   ├─ YES → 全データ削除実行
   └─ NO  → 通常動作（何もしない）
```

---

## ❓ トラブルシューティング

### Q: 削除が実行されない

**確認事項:**
- RESET_ALL_DATA.txt が本当に削除されているか？
- ブラウザのキャッシュをクリアしてリロード
- コンソールにエラーが出ていないか確認

### Q: 保護ファイルを再作成するのを忘れた

**対処法:**
- 次回ページ読み込み時にまた削除が実行されます
- すぐに保護ファイルを作成してください
- データがない状態での削除は無害です

### Q: 本番環境で誤って実行してしまった

**対処法:**
- ❌ 残念ながら復元はできません
- バックアップがあればそれを復元
- 今後は本番環境で保護ファイルを削除しないこと

---

## ✅ チェックリスト

削除を実行する前に確認：

- [ ] 開発環境であることを確認
- [ ] 本番環境ではないことを確認
- [ ] バックアップが必要な場合は取得済み
- [ ] 削除後の影響を理解している
- [ ] 保護ファイルを再作成する準備ができている

---

## 📞 サポート

問題が発生した場合は、開発チームに連絡してください。

---

**最終更新**: 2025-10-28  
**バージョン**: 1.0
